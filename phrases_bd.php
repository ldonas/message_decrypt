<?php

$phrases = [
    [ //1
        'A QUIEN MADRUGA, DIOS LE AYUDA', //Frase correcta
        'O LSJYG NOBDSQO, BJWE RY OUSBO', //Frase cifrada
        'Y L I M N D R G A S U Q O E', //Letras de la frase desordenadas
        'U R J N G B D Q O E S L W Y', //Letras cifradas
        'Y L I M', //Pista
        'Refrán español que recomienda ser diligente para tener éxito en las pretensiones laborales.' //Descripción o información sobre la frase
    ],
    [ //2
        'MAS VALE ESTAR SOLO QUE MAL ACOMPAÑADO',
        'UTX FTKY YXITV XCKC ANY UTK TJCULTMTPC',
        'V M U Ñ T O Q D R C L A P E S',
        'F U N M I C A P V J K T L Y X',
        'V M U',
        'Refrán español que recomienda ser selectivo en la elección de compañías.'
    ],
    [ //3
        'PERRO LADRADOR POCO MORDEDOR',
        'LBIIG OXEIXEGI LGNG SGIEBEGI',
        'D A C R O L P E M',
        'E X N I G O L B S',
        'D A C',
        'Refrán español que recomienda no temer a las personas que hablan mucho.'
    ],
    [ //4
        'A CABALLO REGALADO NO LE MIRES EL DIENTE',
        'Q ZQHQIIN PDYQIQUN WN ID FJPDG DI UJDWBD',
        'S L E T A D M O C I B G N R',
        'G I D B Q U F N Z J H Y W P',
        'S L E',
        'Refrán español que recomienda aceptar los regalos sin criticarlos.'
    ],
    [ //5
        'A LO HECHO, PECHO',
        'L EJ UÑXUJ, NÑXUJ',
        'E L C A P H O',
        'Ñ E X L N U J',
        'E L C',
        'Refrán español que recomienda asumir las consecuencias de los actos realizados.'
    ],
    [ //6
        'AL MAL TIEMPO, BUENA CARA',
        'VR SVR TOÑSEW, HZÑXV NVFV',
        'O B A R E L M I P T U C N',
        'W H V F Ñ R S O E T Z N X',
        'O B A',
        'Refrán español que recomienda mantener una actitud positiva en situaciones adversas.'
    ],
    [ //7
        'CADA LOCO CON SU TEMA',
        'TRFR COTO TON AQ VKER',
        'E N U C L D T M O A S',
        'K N Q T C F V E O R A',
        'E N U',
        'Refrán español que recomienda no interferir en los asuntos de los demás.'
    ],
    [ //8
        'DE TAL PALO, TAL ASTILLA',
        'PQ INY SNYL, INY NTIHYYN',
        'I S O E P T L D A',
        'H T L Q S I Y P N',
        'I S O',
        'Refrán español que recomienda no sorprenderse si los hijos imitan las actitudes de los padres.'
    ],
    [ //9
        'EL QUE LA HACE, LA PAGA',
        'TÑ LZT ÑI WICT, ÑI RIQI',
        'U H G A C P Q E L',
        'Z W Q I C R L T Ñ',
        'U H G',
        'Refrán español que recomienda asumir las consecuencias de los actos realizados.'
    ],
    [ //10
        'EL DINERO LLAMA AL DINERO',
        'IW ACOIHE WWGNG GW ACOIHE',
        'D R I N E L O M A',
        'A H C O I W E N G',
        'D R I',
        'Refrán español que recomienda invertir el dinero para obtener más dinero.'
    ],
    [ //11
        'EL MUNDO ES UN PAÑUELO',
        'PÑ OKHYB PN KH VDMKPÑB',
        'U S M O E D L P N Ñ A',
        'K N O B P Y Ñ V H M D',
        'U S M',
        'Refrán español que recomienda no sorprenderse si se encuentra a alguien conocido en un lugar inesperado.'
    ],
    [ //12
        'A LA TERCERA VA LA VENCIDA',
        'I WI KAMDAMI JI WI JAQDVEI',
        'R E L V C D T N A I',
        'M A W J D E K Q I V',
        'R E L',
        'Refrán español que recomienda no desistir en el intento hasta lograr el objetivo.'
    ],
    [ //13
        'CADA OVEJA CON SU PAREJA',
        'IWFW QXVHW IQJ KP EWOVHW',
        'N A S D P C V O U R J E',
        'J W K F E I X Q P O H V',
        'N A S',
        'Refrán español que recomienda no interferir en los asuntos de los demás.'
    ],
    [ //14
        'MAS VALE PREVENIR QUE CURAR',
        'PCM YCDN GSNYNBIS EAN QASCS',
        'I V A S P R E Q N C M L U',
        'I Y C M G S N E B Q P D A',
        'I V A',
        'Refrán español que recomienda tomar precauciones para evitar problemas futuros.'
    ],
    [ //15
        'MAS VALE TARDE QUE NUNCA',
        'XLQ TLRE DLZSE MWE PWPFL',
        'M C U N S V E D R T A L Q',
        'X F W P Q T E S Z D L R M',
        'M C U',
        'Refrán español que recomienda hacer las cosas a tiempo para evitar problemas futuros.'
    ],
    [ //16
        'EN BOCA CERRADA NO ENTRAN MOSCAS',
        'HB KJIP IHQQPRP BJ HBSQPB EJWIPW',
        'N B M O T A C E S R D',
        'B K E J S P I H W Q R',
        'N B M',
        'Refrán español que recomienda no hablar de más para evitar problemas.'
    ],
    [ //17
        'EL QUE CALLA OTORGA',
        'XH QLX JTHHT NVNDGT',
        'R O T U C A E G Q L',
        'D N V L J T X G Q H',
        'R O T',
        'Refrán español que recomienda no contradecir a alguien que no habla.'
    ],
    [ //18
        'AMOR CON HAMBRE NO DURA',
        'VOAN CAL XVOWNY LA HTNV',
        'U A E O H R M N C D B',
        'T V Y A X N O L C H W',
        'U A E',
        'Refrán español que recomienda no casarse por interés.'
    ],
    [ //19
        'TIRA LA PIEDRA Y ESCONDE LA MANO',
        'YLAS ES VLDFAS C DMJÑGFD ES PSGÑ',
        'I C N O R M P A S D T E Y L',
        'L J G Ñ A P V S M F Y D C E',
        'I C N',
        'Refrán español que recomienda no culpar a otros por los errores propios.'
    ],
    [ //20
        'QUIEN RIE EL ULTIMO, RIE MEJOR',
        'VJMPI RMP PK JKHMAY, RMP APXYR',
        'O Q J T N U R I L M E',
        'Y V X H I J R M K A P',
        'O Q J',
        'Refrán español que recomienda no burlarse de los demás.'
    ],
    [ //21
        'EL HABITO NO HACE AL MONJE',
        'VC LFPMNZ HZ LFWV FC SZHGV',
        'A B M N L I J T H O E C',
        'F P S H C M G N L Z V W',
        'A B M',
        'Refrán español que recomienda no juzgar a las personas por su apariencia.'
    ],
    [ //22
        'A PALABRAS NECIAS, OIDOS SORDOS',
        'Z LZKZUMZV XEHYZV, SYWSV VSMWSV',
        'B O A S D R L P E I C N',
        'U S Z V W M K L E Y H X',
        'B O A',
        'Refrán español que recomienda no hacer caso a las críticas destructivas.'
    ],
    [ //23
        'CREA FAMA Y ACUESTATE A DORMIR',
        'AJCK YKIK E KAVCMTKTC K SUJIRJ',
        'Y E R F S I O C A D T M U',
        'E C J Y M R U A K S T I V',
        'Y E R',
        'Refrán español que recomienda no preocuparse por la opinión de los demás.'
    ],
    [ //24
        'DEL DICHO AL HECHO, HAY MUCHO TRECHO',
        'QOH QVENC YH NOENC, NYK JÑENC TSOENC',
        'H I L A O E C M D Y U T R',
        'N V H Y C O E J Q K Ñ T S',
        'H I L',
        'Refrán español que recomienda no quedarse en las palabras y pasar a la acción.'
    ],
    [ //25
        'DIOS APRIETA PERO NO AHOGA',
        'CERX FQMEOZF QOMR WR FGRJF',
        'O H D P A S N I G R E T',
        'R G C Q F X W E J M O Z',
        'O H D',
        'Refrán español que recomienda no desesperarse en situaciones difíciles.'
    ]

];

$totalPhrases = count($phrases);

//Usamos la suma de año y dia del año como semilla de números aleatorios y generamos uno
srand(date("Y") + date("z"));
$phraseIndex = rand(0, $totalPhrases-1);

function getPhrase() {
    global $phrases, $phraseIndex;
    $phrase = $phrases[$phraseIndex];
    return [
        $phrase[1],
        $phrase[3],
        $phrase[4],
    ];
}

function checkPhrase($userKey) {
    global $phrases, $phraseIndex;
    $phrase = $phrases[$phraseIndex];
    $message = $phrase[1];
    $cypherKey = str_replace(" ", "", $phrase[3]);
    $solved = false;
    for ($i=0; $i < strlen($message); $i++) { 
        $char = strpos(" " . $cypherKey, $message[$i]);
        $message[$i] = ($char) ? $userKey[$char-1] : $message[$i];
    }
    if($message === $phrase[0]){
        $solved = true;
    }
    return ($solved) ? [$solved, $message, $phrase[5]] : [$solved, $message];
}

?>